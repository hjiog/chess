var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,s=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,a=(t,s,n)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,r=(e,r)=>{for(var i in r||(r={}))t.call(r,i)&&a(e,i,r[i]);if(s)for(var i of s(r))n.call(r,i)&&a(e,i,r[i]);return e};import{D as i,f as l,i as o,y as u,j as c,h as p,o as f,b as d,E as h,F as y,G as v,r as m,d as g,w as $,H as b,J as M,K as k,A as w,M as O}from"./vendor.65434684.js";import{c as S,b as x,S as D,d as C,C as T,e as _,P,g as j,f as F,h as W,i as H,a as L,j as R,k as Y,R as N,M as A,l as I,r as U}from"./utils.819595eb.js";const E="undefined"!=typeof window&&window.innerHeight-20;function J(){return{unitWidth:(E||1)/10,chessboardHeight:E}}let q,z={};const B=e=>{const t=JSON.stringify(r(r({},z),e));q.send(t)};const Z=new function(){return new Worker("/chess/assets/index.eaf757b8.js",{type:"module"})};Z.onmessage=e=>{const t=e.data;console.log("AI search result============",t);const{originPostion:s,currentPostion:n}=t;if(s.top===n.top&&s.left===n.left)return void i.success({message:"绝杀!!! 恭喜你赢得本次对局"});S(s,n)&&i.info({message:"你输了>=<"})},Z.addEventListener("error",console.error);var V=l({expose:[],props:{top:Number,left:Number,url:Object,type:Number,getAllMovePosition:Function},setup(e){const t=e,{unitWidth:s}=J(),n=o(s),a=u({top:t.top,left:t.left,isDied:!1}),{chessRefMap:r}=x;r[t.top][t.left]=[a];const l=c((()=>({top:a.top*s+"px",left:a.left*s+"px",width:`${n.value}px`})));let y="";Object.keys(t.url).forEach((e=>{Object.keys(t.url[e]).forEach((s=>{y=t.url[e][s]}))}));const v=c((()=>t.top>=0&&t.left>=0&&!a.isDied)),m=e=>{if(t.getAllMovePosition({top:a.top,left:a.left,chessType:e.type,ChessBoardMap:x.chessTypeMap}).findIndex((t=>t[0]===e.top&&t[1]===e.left))>-1){return S({top:a.top,left:a.left},{top:e.top,left:e.left})&&i.success({message:"你赢了>=<"}),!0}return!1},g=e=>{if(!(D.isPlayFirst?C.value&T.red:C.value&T.black))return;const n=Math.round(e.target.offsetTop/s),a=Math.round(e.target.offsetLeft/s),{currentChessState:r,previousChessState:i}=j.value;t.type&C.value&(T.red|T.black)?(r.top=n,r.left=a,C.value=t.type|T.selected,_.call=m):C.value&T.selected&&_.call({top:n,left:a,type:C.value})&&(D.canStart.value===P.playWithComputer?(console.log("worker.postMessage: ",x.chessTypeMap),Z.postMessage({ChessBoardMap:x.chessTypeMap,isPlayFirst:D.isPlayFirst})):B({preLeft:i.left,preTop:i.top,currentTop:n,currentLeft:a}))},$=()=>{n.value=s+10},b=()=>{n.value=s};return(e,t)=>p(v)?(f(),d("img",{key:0,src:p(y),class:"cursor-pointer z-index-2 absolute",style:p(l),onClick:g,onMouseover:$,onMouseleave:b},null,44,["src"])):h("",!0)}}),G=l({expose:[],props:{type:Number},setup(e){const t=e,{unitWidth:s}=J(),n=c((()=>({top:F[t.type].top*s+"px",left:F[t.type].left*s+"px",width:`${s}px`}))),a=c((()=>{const e=C.value&t.type,s=C.value&T.selected,n=t.type&W.currentState,a=e&&s&&n||!e&&n,r=!e&&!n;return F[t.type].top>=0&&F[t.type].left>=0&&(a||r)})),r=Object.keys(H).find((e=>!!(Number(e)&t.type)));let i="";const l=H[Number(r)];return Object.keys(l).forEach((e=>{Object.keys(l[e]).forEach((t=>{i=l[e][t]}))})),(e,t)=>p(a)?(f(),d("img",{key:0,src:p(i),alt:"",class:"cursor-pointer z-index-1 absolute",style:p(n)},null,12,["src"])):h("",!0)}}),K=y((function(e,t){e.exports=function(){var e="millisecond",t="second",s="minute",n="hour",a="day",r="week",i="month",l="quarter",o="year",u="date",c=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},d=function(e,t,s){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(s)+e},h={s:d,z:function(e){var t=-e.utcOffset(),s=Math.abs(t),n=Math.floor(s/60),a=s%60;return(t<=0?"+":"-")+d(n,2,"0")+":"+d(a,2,"0")},m:function e(t,s){if(t.date()<s.date())return-e(s,t);var n=12*(s.year()-t.year())+(s.month()-t.month()),a=t.clone().add(n,i),r=s-a<0,l=t.clone().add(n+(r?-1:1),i);return+(-(n+(s-a)/(r?a-l:l-a))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(c){return{M:i,y:o,w:r,d:a,D:u,h:n,m:s,s:t,ms:e,Q:l}[c]||String(c||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",v={};v[y]=f;var m=function(e){return e instanceof M},g=function(e,t,s){var n;if(!e)return y;if("string"==typeof e)v[e]&&(n=e),t&&(v[e]=t,n=e);else{var a=e.name;v[a]=e,n=a}return!s&&n&&(y=n),n||!s&&y},$=function(e,t){if(m(e))return e.clone();var s="object"==typeof t?t:{};return s.date=e,s.args=arguments,new M(s)},b=h;b.l=g,b.i=m,b.w=function(e,t){return $(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var M=function(){function f(e){this.$L=g(e.locale,null,!0),this.parse(e)}var d=f.prototype;return d.parse=function(e){this.$d=function(e){var t=e.date,s=e.utc;if(null===t)return new Date(NaN);if(b.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(c);if(n){var a=n[2]-1||0,r=(n[7]||"0").substring(0,3);return s?new Date(Date.UTC(n[1],a,n[3]||1,n[4]||0,n[5]||0,n[6]||0,r)):new Date(n[1],a,n[3]||1,n[4]||0,n[5]||0,n[6]||0,r)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},d.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},d.$utils=function(){return b},d.isValid=function(){return!("Invalid Date"===this.$d.toString())},d.isSame=function(e,t){var s=$(e);return this.startOf(t)<=s&&s<=this.endOf(t)},d.isAfter=function(e,t){return $(e)<this.startOf(t)},d.isBefore=function(e,t){return this.endOf(t)<$(e)},d.$g=function(e,t,s){return b.u(e)?this[t]:this.set(s,e)},d.unix=function(){return Math.floor(this.valueOf()/1e3)},d.valueOf=function(){return this.$d.getTime()},d.startOf=function(e,l){var c=this,p=!!b.u(l)||l,f=b.p(e),d=function(e,t){var s=b.w(c.$u?Date.UTC(c.$y,t,e):new Date(c.$y,t,e),c);return p?s:s.endOf(a)},h=function(e,t){return b.w(c.toDate()[e].apply(c.toDate("s"),(p?[0,0,0,0]:[23,59,59,999]).slice(t)),c)},y=this.$W,v=this.$M,m=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case o:return p?d(1,0):d(31,11);case i:return p?d(1,v):d(0,v+1);case r:var $=this.$locale().weekStart||0,M=(y<$?y+7:y)-$;return d(p?m-M:m+(6-M),v);case a:case u:return h(g+"Hours",0);case n:return h(g+"Minutes",1);case s:return h(g+"Seconds",2);case t:return h(g+"Milliseconds",3);default:return this.clone()}},d.endOf=function(e){return this.startOf(e,!1)},d.$set=function(r,l){var c,p=b.p(r),f="set"+(this.$u?"UTC":""),d=(c={},c[a]=f+"Date",c[u]=f+"Date",c[i]=f+"Month",c[o]=f+"FullYear",c[n]=f+"Hours",c[s]=f+"Minutes",c[t]=f+"Seconds",c[e]=f+"Milliseconds",c)[p],h=p===a?this.$D+(l-this.$W):l;if(p===i||p===o){var y=this.clone().set(u,1);y.$d[d](h),y.init(),this.$d=y.set(u,Math.min(this.$D,y.daysInMonth())).$d}else d&&this.$d[d](h);return this.init(),this},d.set=function(e,t){return this.clone().$set(e,t)},d.get=function(e){return this[b.p(e)]()},d.add=function(e,l){var u,c=this;e=Number(e);var p=b.p(l),f=function(t){var s=$(c);return b.w(s.date(s.date()+Math.round(t*e)),c)};if(p===i)return this.set(i,this.$M+e);if(p===o)return this.set(o,this.$y+e);if(p===a)return f(1);if(p===r)return f(7);var d=(u={},u[s]=6e4,u[n]=36e5,u[t]=1e3,u)[p]||1,h=this.$d.getTime()+e*d;return b.w(h,this)},d.subtract=function(e,t){return this.add(-1*e,t)},d.format=function(e){var t=this;if(!this.isValid())return"Invalid Date";var s=e||"YYYY-MM-DDTHH:mm:ssZ",n=b.z(this),a=this.$locale(),r=this.$H,i=this.$m,l=this.$M,o=a.weekdays,u=a.months,c=function(e,n,a,r){return e&&(e[n]||e(t,s))||a[n].substr(0,r)},f=function(e){return b.s(r%12||12,e,"0")},d=a.meridiem||function(e,t,s){var n=e<12?"AM":"PM";return s?n.toLowerCase():n},h={YY:String(this.$y).slice(-2),YYYY:this.$y,M:l+1,MM:b.s(l+1,2,"0"),MMM:c(a.monthsShort,l,u,3),MMMM:c(u,l),D:this.$D,DD:b.s(this.$D,2,"0"),d:String(this.$W),dd:c(a.weekdaysMin,this.$W,o,2),ddd:c(a.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(r),HH:b.s(r,2,"0"),h:f(1),hh:f(2),a:d(r,i,!0),A:d(r,i,!1),m:String(i),mm:b.s(i,2,"0"),s:String(this.$s),ss:b.s(this.$s,2,"0"),SSS:b.s(this.$ms,3,"0"),Z:n};return s.replace(p,(function(e,t){return t||h[e]||n.replace(":","")}))},d.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},d.diff=function(e,u,c){var p,f=b.p(u),d=$(e),h=6e4*(d.utcOffset()-this.utcOffset()),y=this-d,v=b.m(this,d);return v=(p={},p[o]=v/12,p[i]=v,p[l]=v/3,p[r]=(y-h)/6048e5,p[a]=(y-h)/864e5,p[n]=y/36e5,p[s]=y/6e4,p[t]=y/1e3,p)[f]||y,c?v:b.a(v)},d.daysInMonth=function(){return this.endOf(i).$D},d.$locale=function(){return v[this.$L]},d.locale=function(e,t){if(!e)return this.$L;var s=this.clone(),n=g(e,t,!0);return n&&(s.$L=n),s},d.clone=function(){return b.w(this.$d,this)},d.toDate=function(){return new Date(this.valueOf())},d.toJSON=function(){return this.isValid()?this.toISOString():null},d.toISOString=function(){return this.$d.toISOString()},d.toString=function(){return this.$d.toUTCString()},f}(),k=M.prototype;return $.prototype=k,[["$ms",e],["$s",t],["$m",s],["$H",n],["$W",a],["$M",i],["$y",o],["$D",u]].forEach((function(e){k[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),$.extend=function(e,t){return e.$i||(e(t,M,$),e.$i=!0),$},$.locale=g,$.isDayjs=m,$.unix=function(e){return $(1e3*e)},$.en=v[y],$.Ls=v,$.p={},$}()}));const Q={class:"text-center"},X={class:"container flex flex-row px-5 items-center justify-start"},ee={class:"relative"},te={class:"flex flex-row ml-8 items-center justify-between"},se={class:"w-23"},ne=k(" 先手 "),ae=k(" 后手 "),re=k(" 双人对战 "),ie=k(" 重新开始 "),le=k(" 悔棋 "),oe=g("div",null,"是否悔棋?",-1),ue={class:"mt-3 text-center"},ce=k(" 是 "),pe=k(" 否 "),fe=k(" 悔棋 "),de={key:0,class:"flex flex-col ml-16 w-100"},he=k(" 消息列表 "),ye={class:"bg-gray-100 h-80 overflow-auto"},ve={key:0},me={key:1,class:""},ge={key:2},$e={class:"text-left"},be={key:0},Me={key:1,class:"text-blue-600"},ke={key:2,class:"text-red-600"},we={class:"flex flex-row mt-2"},Oe=k(" 发送 ");var Se=l({expose:[],setup(e){const{chessboardHeight:t,unitWidth:s}=J(),n={height:`${t}px`},a=[W.red|W.currentState,W.red|W.previousState,W.black|W.currentState,W.black|W.previousState],l=o(!1),y=o(!1),v=o(!1),F=D.canStart,H=o(L),E=u([]),Se=o(""),xe=o(""),De=o(!1),Ce=o(!1),Te=c((()=>{if(R()){if(F.value===P.playOnline)return D.isPlayFirst?C.value&T.black:C.value&T.red;if(F.value===P.playWithComputer)return!0}return!1})),_e=()=>K().format("YYYY-MM-DD HH:mm:ss"),Pe=e=>{const t=Math.floor(e.offsetY/s),n=Math.floor(e.offsetX/s);if(T.selected&C.value){const{previousChessState:e}=j.value;_.call({top:t,left:n,type:C.value})&&(F.value===P.playWithComputer?Z.postMessage({ChessBoardMap:x.chessTypeMap,isPlayFirst:D.isPlayFirst}):F.value===P.playOnline&&B({currentTop:t,currentLeft:n,preTop:e.top,preLeft:e.left}))}},je=e=>{F.value=P.waitingStart,E.length=0,setTimeout((()=>{H.value=Y(e),e||Z.postMessage({ChessBoardMap:x.chessTypeMap,isPlayFirst:D.isPlayFirst}),F.value=P.playWithComputer,l.value=!1}))},Fe=e=>{const{currentTop:t,currentLeft:s,preLeft:n,preTop:a}=e;if(t||s){S({top:9-a,left:8-n},{top:9-t,left:8-s})&&i.info({message:"你输了>=<"})}else e.talk?E.unshift({msg:e.talk,type:A.opponent,time:_e()}):e.canOpponentRegret===I.request?O.confirm({title:"提示",content:"对手请求悔棋,是否同意?",maskClosable:!1,closable:!1,okText:"同意",cancelText:"拒绝",onOk:()=>{B({canOpponentRegret:I.agree}),U()},onCancel:()=>{B({canOpponentRegret:I.disagree})}}):e.canOpponentRegret===I.agree?(De.value=!1,U()):e.canRestart===N.request?O.confirm({title:"提示",content:"对手请求重开,是否同意?",maskClosable:!1,closable:!1,okText:"同意",cancelText:"拒绝",onOk:()=>{B({canRestart:N.agree}),F.value=P.waitingStart,setTimeout((()=>{D.isPlayFirst=e.isPlayFirst,H.value=Y(e.isPlayFirst),F.value=P.playOnline}))},onCancel:()=>{B({canRestart:N.disagree})}}):e.canRestart===N.agree?(Ce.value=!1,F.value=P.waitingStart):(e.canRestart===N.disagree?Ce.value=!1:e.canOpponentRegret===I.disagree&&(De.value=!1),E.unshift({msg:e.msg,type:A.system,time:_e()}));e.canStart&&F.value!==P.playOnline&&setTimeout((()=>{D.isPlayFirst=e.isPlayFirst,H.value=Y(e.isPlayFirst),F.value=P.playOnline}))},We=()=>{Se.value&&(B({roomID:Number(Se.value)}),v.value=!1)},He=()=>{var e;F.value!==P.playOnline?(e=Fe,q||(q=new WebSocket("wss://service-qgnrlvfs-1300852544.gz.apigw.tencentcs.com/release"),q.onopen=()=>{console.log("Connection open ..."),q.send("")},q.onmessage=t=>{try{const s=JSON.parse(t.data);console.log("Received RecieverType: ",s),z=r(r({},s),{currentLeft:0,currentTop:0,preLeft:0,preTop:0,canOpponentRegret:0,canRestart:0,msg:"",talk:""}),null==e||e(s)}catch(s){console.log(s)}},q.onclose=function(){console.log("Connection closed.")},q.onerror=e=>{console.error(e)}),v.value=!0):(Ce.value=!0,B({canRestart:N.request}))},Le=()=>{E.unshift({type:A.yours,msg:xe.value,time:_e()}),B({talk:xe.value}),xe.value=""},Re=()=>{y.value=!1,F.value===P.playOnline?(B({canOpponentRegret:I.request}),De.value=!0):Te.value&&(U(),U())};return(e,t)=>{const s=m("a-input-number"),r=m("a-modal"),i=V,o=G,u=m("a-button"),c=m("a-popover"),O=m("a-typography-title"),S=m("a-comment"),x=m("a-input");return f(),d(b,null,[g(r,{visible:v.value,"onUpdate:visible":t[2]||(t[2]=e=>v.value=e),title:"请输入房间号","cancel-text":"取消","ok-text":"确定",width:320,onOk:We},{default:$((()=>[g("div",Q,[g(s,{value:Se.value,"onUpdate:value":t[1]||(t[1]=e=>Se.value=e),min:1},null,8,["value"])])])),_:1},8,["visible"]),g("div",X,[g("div",ee,[g("img",{src:"/chess/assets/chessBoard.c99e3739.jpg",alt:"",style:n,onClick:Pe}),p(F)?(f(),d(b,{key:0},[(f(!0),d(b,null,M(Object.keys(H.value).map((e=>Number(e))),(e=>(f(),d(b,{key:e},[(f(!0),d(b,null,M(H.value[e].position,(t=>(f(),d(i,{key:t,top:t.top,left:t.left,url:H.value[e].url,"get-all-move-position":H.value[e].getAllMovePosition,type:e},null,8,["top","left","url","get-all-move-position","type"])))),128))],64)))),128)),(f(),d(b,null,M(a,(e=>g(o,{key:e,type:e},null,8,["type"]))),64))],64)):h("",!0)]),g("div",te,[g("div",se,[g(c,{visible:l.value,"onUpdate:visible":t[5]||(t[5]=e=>l.value=e),placement:"top",trigger:"click"},{content:$((()=>[g(u,{type:"primary",class:"mx-2 inline",onClick:t[3]||(t[3]=e=>je(!0))},{default:$((()=>[ne])),_:1}),g(u,{type:"primary",class:"mx-2 inline",onClick:t[4]||(t[4]=e=>je(!1))},{default:$((()=>[ae])),_:1})])),default:$((()=>[g(u,{type:"primary",class:"my-2 w-22"},{default:$((()=>[k(w(p(F)===p(P).playWithComputer?"重新开始":"单人对战"),1)])),_:1})])),_:1},8,["visible"]),g(u,{type:"primary",class:"my-2",loading:Ce.value,onClick:He},{default:$((()=>[p(F)===p(P).waitingStart?(f(),d(b,{key:0},[re],64)):(f(),d(b,{key:1},[ie],64))])),_:1},8,["loading"]),p(Te)?h("",!0):(f(),d(u,{key:0,type:"primary",class:"my-2 w-22",disabled:""},{default:$((()=>[le])),_:1})),p(Te)?(f(),d(c,{key:1,visible:y.value,"onUpdate:visible":t[7]||(t[7]=e=>y.value=e),placement:"bottom",trigger:"click"},{content:$((()=>[g("div",null,[oe,g("div",ue,[g(u,{type:"primary",class:"mr-2 inline",onClick:Re},{default:$((()=>[ce])),_:1}),g(u,{type:"primary",class:"inline",onClick:t[6]||(t[6]=e=>y.value=!1)},{default:$((()=>[pe])),_:1})])])])),default:$((()=>[g(u,{class:"my-2 w-22",type:"primary",loading:De.value},{default:$((()=>[fe])),_:1},8,["loading"])])),_:1},8,["visible"])):h("",!0)]),p(E).length?(f(),d("div",de,[g(O,{level:5},{default:$((()=>[he])),_:1}),g("div",ye,[(f(!0),d(b,null,M(p(E),(e=>(f(),d(S,{key:e,class:"-mb-4"},{author:$((()=>[e.type===p(A).system?(f(),d("span",ve,"系统")):h("",!0),e.type===p(A).yours?(f(),d("span",me,"你")):h("",!0),e.type===p(A).opponent?(f(),d("span",ge,"对手")):h("",!0)])),content:$((()=>[g("div",$e,[e.type===p(A).system?(f(),d("span",be,w(e.msg),1)):h("",!0),e.type===p(A).yours?(f(),d("span",Me,w(e.msg),1)):h("",!0),e.type===p(A).opponent?(f(),d("span",ke,w(e.msg),1)):h("",!0)])])),datetime:$((()=>[k(w(e.time),1)])),_:2},1024)))),128))]),g("div",we,[g(x,{value:xe.value,"onUpdate:value":t[8]||(t[8]=e=>xe.value=e),placeholder:"请输入聊天内容"},null,8,["value"]),g(u,{type:"primary",class:"ml-4 w-18",disabled:!xe.value||p(F)!==p(P).playOnline,onClick:Le},{default:$((()=>[Oe])),_:1},8,["disabled"])])])):h("",!0)])])],64)}}}),xe=l({expose:[],setup:e=>(e,t)=>{const s=Se;return f(),d(s)}}),De={};"function"==typeof De&&De(xe);export default xe;
